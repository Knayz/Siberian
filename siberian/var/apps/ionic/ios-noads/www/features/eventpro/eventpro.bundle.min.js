angular.module('starter').controller('EventproHomeController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.show_header=!0;angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findAll().then(function(data){$scope.payout=data;$scope.settings=Eventpro.settings=data.settings;$scope.page_title=data.page_title;$scope.is_loading=!1},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent()});angular.module('starter').controller('EventproEventsController',function(Dialog,$controller,Eventpro,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.category_id=$stateParams.category_id;$scope.type=$stateParams.type;$scope.filterBy=$stateParams.type;$scope.payout={events:{}}
$scope.page_title=$translate.instant("Events","eventpro");if($scope.type=='thisweek'){$scope.page_title=$translate.instant("This Week Events","eventpro")}
if($scope.type=='freeevent'){$scope.page_title=$translate.instant("Free Events","eventpro")}
angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findEventsByCategory($scope.category_id,$scope.type,$scope.payout.events.length).then(function(data){$scope.payout=data;$scope.can_load_older_posts_list=!!data.events.length},function(error){$scope.can_load_older_posts_list=!1;$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1;$rootScope.$broadcast("refreshPageSize");$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadMoreEvents=function(){if(!$scope.payout.events.length){return!1}
Eventpro.findEventsByCategory($scope.category_id,$scope.type,$scope.payout.events.length).then(function(data){$scope.can_load_older_posts_list=!!data.events.length;$scope.payout.events=$scope.payout.events.concat(data.events);$rootScope.$broadcast("refreshPageSize")}).error(function(error){$scope.can_load_older_posts_list=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,"OK",-1,"eventpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()});angular.module('starter').controller('EventproCategoriesController',function(Dialog,Eventpro,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={};$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findCategory().then(function(data){$scope.payout=data;$scope.is_loading=!1},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent()});angular.module('starter').controller('EventproCommanController',function(Dialog,Eventpro,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.artist_info={};$scope.organizer_info={};$scope.event_info={};$scope.carts={};$scope.is_choice_date=!1;$scope.settings=Eventpro.settings;$scope.eventInfo=function(event_id){if(event_id>0){$scope.event_info={};Loader.show();$ionicModal.fromTemplateUrl('features/eventpro/assets/templates/modal/event_info.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Eventpro.findEventById(event_id).then(function(data){$scope.event_info=data.event;$scope.is_choice_date=!1;if(!$scope.event_info.is_series_parent){$scope.is_choice_date=!0}},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()});$scope.modalEventInfo=modal;$scope.modalEventInfo.show()})}};$scope.choiceEventDate=function(event_id){Loader.show();$ionicModal.fromTemplateUrl('features/eventpro/assets/templates/modal/select_date.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Eventpro.findEventDatesById(event_id).then(function(data){$scope.event_dates=data.dates;$scope.isPast=!1},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()});$scope.modalDatesEvent=modal;$scope.modalDatesEvent.show()})};$scope.closeModalDatesEvent=function(){$scope.modalDatesEvent.remove()}
$scope.pastEventShow=function(is_sale_end){console.log(is_sale_end,$scope.isPast);if(is_sale_end&&$scope.isPast){return!0}
if(!is_sale_end&&!$scope.isPast){return!0}}
$scope.dateTab=function(isPast){console.log('isPast',$scope.isPast);$scope.isPast=isPast}
$scope.closeModalEventInfo=function(){$scope.modalEventInfo.remove()}
$scope.artistInfo=function(artist_id){$scope.artist_info={};Loader.show();$ionicModal.fromTemplateUrl('features/eventpro/assets/templates/modal/artist_info.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Eventpro.findArtistById(artist_id).then(function(data){$scope.artist_info=data},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()});$scope.modalArtistInfo=modal;$scope.modalArtistInfo.show()})};$scope.closeModalArtistInfo=function(){$scope.modalArtistInfo.remove()}
$scope.organizerInfo=function(organizer_id){$scope.organizer_info={};Loader.show();$ionicModal.fromTemplateUrl('features/eventpro/assets/templates/modal/organizer_info.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Eventpro.findOrganizerById(organizer_id).then(function(data){$scope.organizer_info=data},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()});$scope.modalOrganizerInfo=modal;$scope.modalOrganizerInfo.show()})};$scope.closeModalOrganizerInfo=function(){$scope.modalOrganizerInfo.remove()}
$scope.customerImage=function(image){if(image!=''&&image!=null&&image!="null"){return IMAGE_URL+'images/application'+image}else{return"./features/eventpro/assets/media/customer-placeholder.png"}};$scope.eventproImage=function(image){if(image!=''&&image!=null&&image!="null"){return IMAGE_URL+'images/application'+image}else{return"./features/eventpro/assets/media/no_image.jpg"}};$scope.selectEventDate=function(event){if(event.is_sale_end){return!1}
$scope.carts.child_event=event;$scope.is_choice_date=!0;$scope.closeModalDatesEvent()}
$scope.bookNow=function(event){if(event.is_series_parent&&!$scope.is_choice_date){$scope.choiceEventDate(event.id);return!0}
$scope.carts.event=event;$scope.carts.event.tickets_qty=$scope.carts.event.minimum_quantity;Eventpro.carts=$scope.carts;$scope.closeModalEventInfo();$timeout(function(){$state.go("eventpro-cart",{value_id:$scope.value_id,event_id:event.id},{reload:!0})},300)};$scope.range=function(min,max){var input=[];for(var i=min;i<=max;i++)input.push(i);return input};$scope.forTranslate=function(text){return $translate.instant(text,"eventpro")}
$scope.saveFavorites=function(event_id){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){Loader.show();$timeout(function(){Loader.hide();$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$scope.eventInfo(event_id)})})},300)})}
Loader.show();Eventpro.saveFavorites(event_id).then(function(data){Eventpro.findEventById(event_id).then(function(data){$scope.event_info=data.event;$scope.is_choice_date=!1;if(!$scope.event_info.is_series_parent){$scope.is_choice_date=!0}},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()})},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()})}});angular.module('starter').controller('EventproArtistsController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={};$scope.show_header=!1;angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findAllArtists().then(function(data){$scope.payout=data;$scope.is_loading=!1},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent()});angular.module('starter').controller('EventproOrganizersController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={};$scope.show_header=!1;angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findAllOrganizers().then(function(data){$scope.payout=data;$scope.is_loading=!1},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent()});angular.module('starter').controller('EventproProcessController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={};angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.carts=Eventpro.carts;$scope.is_child_event=!1;if(!Eventpro.isUndefined($scope.carts.child_event)&&$scope.carts.child_event.id>0){$scope.is_child_event=!0}};$scope.loadContent();$scope.continueBooking=function(){Eventpro.carts=$scope.carts;$state.go("eventpro-checkout",{value_id:$scope.value_id},{reload:!0})}}).controller('EventproCheckoutController',function(Dialog,$window,Application,$ionicLoading,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={};$scope.is_logged_in=Customer.isLoggedIn();$scope.settings=Eventpro.settings;$scope.loadContent=function(){$scope.carts=Eventpro.carts;if(Eventpro.isUndefined($scope.carts.event.id)){$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0})})}
$scope.carts.payment_method='';if($scope.carts.event.price==0){$scope.carts.payment_method='NA'}
if(!$scope.settings.enable_cod&&!$scope.settings.enable_online_payment){$scope.carts.payment_method='NA'}
$scope.carts.customer=Customer.customer;$scope.is_loading=!0;Eventpro.checkoutScreen().then(function(data){$scope.gateways=data.gateways;$scope.carts.customer.phone_number=data.phone_number},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent();$scope.login=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){Loader.show();$timeout(function(){Loader.hide();$scope.is_logged_in=Customer.isLoggedIn();$state.go("eventpro-checkout",{value_id:$scope.value_id},{reload:!0})},300)})}}
$scope.forTranslate=function(text){return $translate.instant(text,"eventpro")}
$scope.updateOrderStatus=function(param){var order_id=param.order_id;Loader.show();Eventpro.updatePaymentStatus(param).then(function(data){Loader.hide();if(param.status=='success'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been successfully","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
if(param.status=='failed'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been failed","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-orders",{value_id:$scope.value_id,order_id:order_id},{reload:!0})})})},function(error){Loader.hide();Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("OK","eventpro"),-1,"eventpro")})}
$scope.populateURL=function(param){if(!Application.is_webview){Loader.hide();$ionicLoading.show({content:$translate.instant("Please wait ...","eventpro"),animation:'fade-in',showBackdrop:!0,maxWidth:200,showDelay:0});var browser=$window.open(param.paypal_url,$rootScope.getTargetForLink(),'location=yes');browser.addEventListener('loadstart',function(event){var newurl=event.url.split('/?__goto__=');var res=newurl[0].concat(newurl[1]);if(/(confirm)/.test(event.url)){var url=event.url;var first_split=url.split('?');var second_split=first_split[1].split('&');var token_split=second_split[0].split('=');var tokenId=token_split[1];var payer_split=second_split[1].split('=');var payerId=payer_split[1];if(tokenId!=''&&payerId!=''){$scope.cart=param;$scope.cart.status='success';$scope.cart.tokenId=tokenId;$scope.cart.txn=payerId;$scope.updateOrderStatus($scope.cart);browser.close();$ionicLoading.hide()}else{$scope.cart=param;$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.txn='';$scope.updateOrderStatus($scope.cart);browser.close();$ionicLoading.hide()}}else if(/(cancel)/.test(event.url)){$scope.cart=param;$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.txn='';$scope.updateOrderStatus($scope.cart);browser.close();$ionicLoading.hide()}})}else{$window.location=param.paypal_url}}
$scope.placeOrder=function(){if(Eventpro.isUndefined($scope.carts.event.id)){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Something went wrong, Please try again later!","eventpro"),$translate.instant("Ok","eventpro"),-1,'eventpro');return!1}
var event_child_id=0;if(!Eventpro.isUndefined($scope.carts.child_event)){var event_child_id=$scope.carts.child_event.id}
var param={event_id:$scope.carts.event.id,event_child_id:event_child_id,payment_method:$scope.carts.payment_method,email:$scope.carts.customer.email,phone_number:$scope.carts.customer.phone_number,firstname:$scope.carts.customer.firstname,lastname:$scope.carts.customer.lastname,tickets_qty:$scope.carts.event.tickets_qty,price:$scope.carts.event.price,}
Loader.show();Eventpro.orderNow(param).then(function(data){Eventpro.carts={};$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){if(data.paypal_payment_url!=''&&data.payment_method=='paypal'){$scope.carts.order_id=data.order_id;$scope.carts.paypal_url=data.paypal_payment_url;Eventpro.set_local('PAYPAL_BEFORE_DATA',JSON.stringify($scope.carts));$scope.populateURL($scope.carts)}else{$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("eventpro-order-success",{value_id:$scope.value_id,order_id:data.order_id},{reload:!0})})}})},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')})}}).controller('EventproSuccessController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.order_id=$stateParams.order_id;$scope.payout={};$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findByOrderId($scope.order_id).then(function(data){$scope.payout=data;if(data.order.payment_method=='wallet'){Loader.show();$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("eventpro-ewallet",{value_id:$scope.value_id,order_id:$scope.order_id},{reload:!0})})})}},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})};$scope.loadContent();$scope.goToHome=function(){$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0})})}
$scope.goToViewOrder=function(){$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-orders",{value_id:$scope.value_id,order_id:$scope.order_id},{reload:!0})})})}}).controller('EventproPaypalReturnController',function(Dialog,Loader,Customer,$filter,Modal,$ionicPopup,$ionicScrollDelegate,$timeout,$ionicHistory,$rootScope,SB,Eventpro,$scope,$state,$stateParams,$translate,Ewallet,$ionicHistory,$ionicSideMenuDelegate){Loader.show();$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.cart=JSON.parse(Eventpro.get_local('PAYPAL_BEFORE_DATA'));Eventpro.unset_local('PAYPAL_BEFORE_DATA');$scope.updateOrderStatus=function(param){var order_id=param.order_id;Loader.show();Eventpro.updatePaymentStatus(param).then(function(data){Loader.hide();if(param.status=='success'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been successfully","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
if(param.status=='failed'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been failed","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-orders",{value_id:$scope.value_id,order_id:order_id},{reload:!0})})})},function(error){Loader.hide();Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("OK","eventpro"),-1,"eventpro")})}
$scope.loadContent=function(){Loader.show();if(Application.is_webview){var url=$location.absUrl();if(url.indexOf("?")>-1){var first_split=url.split('?');var second_split=first_split[1].split('&');if(second_split.length>1){var token_split=second_split[0].split('=');var tokenId=token_split[1];var payer_split=second_split[1].split('=');var payerId=payer_split[1];$scope.cart.status='success';$scope.cart.tokenId=tokenId;$scope.cart.txn=payerId;$scope.updateOrderStatus($scope.cart)}else{$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.txn='';$scope.updateOrderStatus($scope.cart)}}}}
Application.loaded.then(function(){$scope.loadContent()})});angular.module('starter').controller('EventproOrdersController',function(Dialog,Eventpro,$controller,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.order_id=$stateParams.order_id;$scope.payout={};$scope.is_logged_in=Customer.isLoggedIn();angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.loadContent=function(){$scope.is_loading=!0;Eventpro.findOrderByCustomerId().then(function(data){$scope.payout=data},function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1});$timeout(function(){console.log('$scope.order_id',$scope.order_id);if(!Eventpro.isUndefined($scope.order_id)&&$scope.order_id!=''&&$scope.order_id!=null){$scope.orderDetails($scope.order_id);$scope.order_id=''}},300)};$scope.loadContent();$scope.login=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){Loader.show();$timeout(function(){Loader.hide();$scope.is_logged_in=Customer.isLoggedIn();$state.go("eventpro-orders",{value_id:$scope.value_id},{reload:!0})},300)})}}
$scope.convertDate=function(date){return $filter('moment_calendar')((new Date(date)).getTime())};$scope.orderDetails=function(order_id){$scope.order_info={};Loader.show();$ionicModal.fromTemplateUrl('features/eventpro/assets/templates/modal/order_details.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Eventpro.findByOrderId(order_id).then(function(data){$scope.order_info=data.order},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){Loader.hide()});$scope.modalOrderDeatils=modal;$scope.modalOrderDeatils.show()})};$scope.closeModalOrderDeatils=function(){$scope.modalOrderDeatils.remove()}});angular.module('starter').controller('EventproEwalletController',function(Dialog,Loader,Customer,$filter,Modal,$ionicPopup,$ionicScrollDelegate,$timeout,$ionicHistory,$rootScope,SB,Eventpro,$scope,$state,$stateParams,$translate,Ewallet,$ionicHistory,$ionicSideMenuDelegate){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.order_id=$stateParams.order_id;$scope.is_loading=!1;$scope.loadContent=function(){$scope.cart={};Loader.show();Eventpro.findByOrderId($scope.order_id).then(function(data){$scope.payout=data;$scope.cart.method=='payToModule';$scope.cart.order_id=$scope.order_id;$scope.cart.amount=data.order.total_amount;$scope.cart.currency_code=data.order.currency;$scope.cart.currency_symbol=data.order.currency;$scope.cart.remark="Order #"+$scope.order_id;$scope.cart.return_state_name='eventpro-ewallet-return';$scope.cart.return_value_id=$scope.value_id;Ewallet.setPaycart($scope.cart);$ionicHistory.nextViewOptions({disableBack:!0});$ionicSideMenuDelegate.canDragContent(!1);$state.go("ewallet-module-payment",{value_id:data.ewallet_value_id},{reload:!0});Loader.hide()},function(error){Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1})}
$scope.loadContent()}).controller('EventproEwalletReturnController',function(Dialog,Loader,Customer,$filter,Modal,$ionicPopup,$ionicScrollDelegate,$timeout,$ionicHistory,$rootScope,SB,Eventpro,$scope,$state,$stateParams,$translate,Ewallet,$ionicHistory,$ionicSideMenuDelegate){$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.cart=Ewallet.getPaycart();console.log($scope.cart);$ionicHistory.nextViewOptions({historyRoot:!0,disableAnimate:!1,disableBack:!0});$ionicSideMenuDelegate.canDragContent(!0);Loader.show();Eventpro.updatePaymentStatus($scope.cart).then(function(data){Loader.hide();if($scope.cart.status=='success'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been successfully","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
if($scope.cart.status=='failed'){Dialog.alert($translate.instant("Error","eventpro"),$translate.instant("Payment has been failed","eventpro"),$translate.instant("OK","eventpro"),-1,"eventpro")}
Ewallet.setPaycart({});$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("eventpro-orders",{value_id:$scope.value_id,order_id:$scope.cart.order_id},{reload:!0})})})},function(error){Loader.hide();Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("OK","eventpro"),-1,"eventpro")})});angular.module('starter').controller('EventproSearchController',function(Dialog,$controller,Eventpro,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){angular.extend(this,$controller('EventproCommanController',{$ionicModal:$ionicModal,Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams}));$scope.value_id=Eventpro.value_id=$stateParams.value_id;$scope.payout={events:{},search_text:''}
$scope.loadSearchContent=function(){$scope.payout.search_text=document.getElementById("eventSearch").value;if($scope.payout.search_text==''){$scope.payout.products={};if($scope.pull_to_refresh){$scope.$broadcast('scroll.refreshComplete');$scope.pull_to_refresh=!1}
return!1}
console.log("search_text",$scope.payout.search_text);$scope.is_loading=!0;Eventpro.searchEvents($scope.payout.search_text,$scope.payout.events.length).then(function(data){$scope.payout.events=data.events;$scope.can_load_older_posts_list=!!data.events.length},function(error){$scope.is_loading=!1;$scope.can_load_older_posts_list=!1;Dialog.alert($translate.instant("Error","eventpro"),error.message,$translate.instant("Ok","eventpro"),-1,'eventpro')}).then(function(){$scope.is_loading=!1;$rootScope.$broadcast("refreshPageSize");$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.searchLoadMoreEvents=function(){if(!$scope.payout.events.length){return!1}
Eventpro.searchEvents($scope.payout.search_text,$scope.payout.events.length).then(function(data){$scope.can_load_older_posts_list=!!data.events.length;$scope.payout.events=$scope.payout.events.concat(data.events)},function(error){$scope.can_load_older_posts_list=!1}).then(function(){$rootScope.$broadcast("refreshPageSize");$scope.$broadcast('scroll.infiniteScrollComplete')})}});angular.module('starter').factory('Eventpro',function(Application,$sbhttp,Url,$location,$window,$rootScope,Pages,Customer,$state,$pwaRequest,$ionicPlatform,$session,Dialog,SB,$ionicPopup,$translate,$httpParamSerializer){var factory={};factory.value_id=null;factory.settings={};factory.filters={};factory.carts={};factory.StripeInstance=null;factory.setValueId=function(valueId){factory.value_id=valueId;return factory};factory.getValueId=function(){return factory.value_id};factory.get_local=function(key){return $window.localStorage.getItem(key)||null}
factory.set_local=function(key,id){$window.localStorage.setItem(key,id)}
factory.unset_local=function(key){$window.localStorage.removeItem(key)}
factory.isUndefined=function(thing){return(typeof thing==="undefined")}
factory.findAll=function(){return $pwaRequest.post('eventpro/mobile_view/find-all',{data:{value_id:factory.value_id},refresh:!0})};factory.findEventsByCategory=function(category_id,type,offset){return $pwaRequest.post('eventpro/mobile_event/find-by-category',{data:{value_id:factory.value_id,category_id:category_id,offset:offset,type:type},refresh:!0})};factory.searchEvents=function(search_text,offset){return $pwaRequest.post('eventpro/mobile_event/find-by-category',{data:{value_id:factory.value_id,search_text:search_text,offset:offset},refresh:!0})};factory.findCategory=function(){return $pwaRequest.post('eventpro/mobile_category/find-all',{data:{value_id:factory.value_id},refresh:!0})};factory.findArtistById=function(artist_id){return $pwaRequest.post('eventpro/mobile_artist/find-info',{data:{value_id:factory.value_id,artist_id:artist_id},refresh:!0})};factory.findOrganizerById=function(organizer_id){return $pwaRequest.post('eventpro/mobile_organizer/find-info',{data:{value_id:factory.value_id,organizer_id:organizer_id},refresh:!0})};factory.findEventById=function(event_id){return $pwaRequest.post('eventpro/mobile_event/find-by-id',{data:{value_id:factory.value_id,event_id:event_id},refresh:!0})};factory.findEventDatesById=function(event_id){return $pwaRequest.post('eventpro/mobile_event/find-event-dates-by-id',{data:{value_id:factory.value_id,event_id:event_id},refresh:!0})};factory.findAllArtists=function(offset=0){return $pwaRequest.post('eventpro/mobile_artist/find-all',{urlParams:{value_id:factory.value_id,offset:offset},refresh:!0})};factory.findAllOrganizers=function(offset=0){return $pwaRequest.post('eventpro/mobile_organizer/find-all',{urlParams:{value_id:factory.value_id,offset:offset},refresh:!0})};factory.orderNow=function(params){params.is_webview=Application.is_webview;params.current_url=$location.url();params.BASE_PATH=BASE_PATH;return $pwaRequest.post('eventpro/mobile_order/save',{urlParams:{value_id:factory.value_id,},data:params,refresh:!0})};factory.checkoutScreen=function(){return $pwaRequest.post('eventpro/mobile_order/checkout-screen',{urlParams:{value_id:factory.value_id},refresh:!0})};factory.findByOrderId=function(order_id){return $pwaRequest.post('eventpro/mobile_order/find-by-order-id',{urlParams:{value_id:factory.value_id,order_id:order_id},refresh:!0})};factory.findOrderByCustomerId=function(){return $pwaRequest.post('eventpro/mobile_order/find-all-orders',{urlParams:{value_id:factory.value_id,},refresh:!0})};factory.updatePaymentStatus=function(params){return $pwaRequest.post('eventpro/mobile_order/update-payment-status',{urlParams:{value_id:factory.value_id,},data:params,refresh:!0})};factory.saveFavorites=function(event_id){return $pwaRequest.post('eventpro/mobile_view/save-favorites',{urlParams:{value_id:factory.value_id,event_id:event_id},refresh:!0})};return factory});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.eventpro .remove-border{border:0}.eventpro .eventpro-artist-grid-img{border-radius:50%}.eventpro .eventpro-organizers-grid-img{border-radius:50%}.eventpro .event_grid .event_title{font-size:12px;margin-top:0;margin-bottom:0}.eventpro .event_grid .category_name{margin-top:0}.eventpro .eventpro-category-item{padding:12px 0}.eventpro .eventpro-event-image-overlay-content{margin-top:-45px;background-color:rgba(0,0,0,.5);position:relative;color:#fff;font-size:14px}.eventpro .event-category-badge{margin-top:10px}.eventpro .event-list-sub-title{margin-top:0}.eventpro .event-list-event-title{margin-bottom:0}.eventpro .interest-recently-icon{font-size:18px}.eventpro .order-img{object-fit:cover}.eventpro .thankyou-success-icon>i{font-size:50px}.eventpro .home-serach-list{margin:0;width:100%}","eventpro")