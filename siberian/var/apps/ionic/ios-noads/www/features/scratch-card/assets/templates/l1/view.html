<ion-view class="module-scratchcard scratch-card-view"
          sb-page-background>
    <ion-nav-title>{{ page_title }}</ion-nav-title>

    <ion-content>

        <div class="loader"
             ng-show="isLoading">
            <ion-spinner class="spinner-custom"></ion-spinner>
        </div>

        <div ng-show="!isLoading">

            <ion-list ng-if="!isLoading && !card.card_id">
                <ion-item class="item-text-wrap item-custom">
                    {{ ::'No cards for now.' | translate:'scratchcard' }}
                </ion-item>
            </ion-list>

            <ion-list class="card"
                      ng-if="collection.available_rewards.length || card.card_id">
                <div ng-if="card.card_id">

                    <ion-item class="item-text-wrap item-icon-left item-custom"
                         ng-if="card.description">
                        <i class="icon ion-information-circled"></i>
                        <p ng-bind-html="card.description | trusted_html"></p>
                    </ion-item>

                    <ion-item class="item-text-wrap item-icon-left item-custom"
                         ng-click="login()"
                         ng-if="!isLoggedIn">
                        <i class="icon ion-ios-person-outline"></i>
                        {{ ::'Click here to log-in' | translate:'scratchcard' }}
                    </ion-item>

                    <ion-item class="item-image"
                         ng-if="!isLoggedIn || card.is_locked">
                        <img ng-src="{{ imageSrc(image) }}"
                             ng-click="alertLogin()" />
                    </ion-item>

                    <ion-item class="item-image"
                         ng-show="isLoggedIn && !card.is_locked">
                        <div sb-scratch
                             ng-if="card"
                             card="card"
                             value-id="value_id"
                             customer-id="customer_id"
                             end-scratch="endScratch()"
                             log="log(is_win, points_earned)"></div>
                    </ion-item>

                    <ion-item class="item-text-wrap item-icon-left item-custom"
                         ng-click="showTc()"
                         ng-if="tc_id">
                        <i class="icon ion-document-text"></i>
                        {{ ::'Terms &amp; Conditions' | translate:'scratchcard' }}
                    </ion-item>
                </div>

                <div ng-show="collection.available_rewards.length">
                    <div class="card"
                         ng-repeat="reward in collection.available_rewards">
                        <ion-item class="item-divider item-divider-custom">
                            {{ reward.name }}
                        </ion-item>
                        <ion-item class="item-icon-left item-text-wrap item-custom">
                            <i class="icon ion-ios-star"></i>
                            {{ reward.description }}
                        </ion-item>
                        <ion-item class="item-custom"
                                  ng-click="openPad(reward)">
                            {{ ::'Use this coupon' | translate:'scratchcard' }}
                        </ion-item>
                    </div>
                </div>
            </ion-list>

            <sb-pad ng-if="show_pad"
                    card="card"></sb-pad>

        </div>

    </ion-content>
</ion-view>