<ion-view sb-page-background
          class="module-inbox inbox-list inbox-l1">

    <ion-nav-title>{{ page_title }}</ion-nav-title>

    <ion-nav-buttons side="secondary">
        <button ng-click="refresh()"
                class="button button-clear header-item">
            <i class="icon ion-sb-refresh"></i>
        </button>
    </ion-nav-buttons>

    <ion-content>
        <div class="loader"
             ng-show="is_loading">
            <ion-spinner class="spinner-custom"></ion-spinner>
        </div>

        <ion-list ng-class="{
                    'card': settings.display_card,
                    'compact': settings.display_compact,
                    'compact card': settings.display_compact_card }"
                  ng-show="!is_loading">
            <ion-item class="item-custom"
                      ng-click="showItem(item)"
                      ng-repeat="item in collection"
                      ng-class="{'item-thumbnail-left': item.picture}">
                <img ng-src="{{ item.picture }}"
                     ng-if="item.picture" />
                <h2>{{ item.title }}</h2>
                <p class="inbox-message-date"
                   ng-if="item.send_at">
                    <i class="ion-ios-calendar-outline"></i>
                    {{ item.send_at }}
                </p>
                <span class="new-message"
                      ng-if="item.is_new">{{ ::'new' | translate:'inbox' }}</span>
                <span class="new-reply"
                      ng-if="!item.is_new && item.has_new_reply">{{ ::'new reply' | translate:'inbox' }}</span>
            </ion-item>

            <ion-item class="item-custom text-center"
                 ng-if="!collection.length && is_logged_in">
                {{ ::'No items found' | translate:'inbox' }}
            </ion-item>

            <ion-item class="item-custom item-text-wrap"
                      ng-show="!is_logged_in">
                <p class="text-justify">
                    {{ ::'You have to be connected to use the Inbox. Please connect to your account by clicking on the button below.' | translate:'inbox' }}
                </p>
            </ion-item>

            <button class="button button-full button-positive-custom"
                    ng-show="!is_logged_in"
                    ng-click="login()">{{ ::'Connect me!' | translate:'inbox' }}</button>
        </ion-list>

        <ion-infinite-scroll ng-if="can_load_older_posts"
                             on-infinite="loadContent(true)"
                             immediate-check="false"
                             distance="10%">
        </ion-infinite-scroll>
    </ion-content>
</ion-view>

